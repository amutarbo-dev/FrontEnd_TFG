<ion-menu contentId="main-content">
  <ion-header>
    <ion-toolbar>
      <ion-title color="secondary">MyAllergens</ion-title>
    </ion-toolbar>
  </ion-header>
  <ion-content class="ion-padding">
    <ion-list *ngFor="let item of paths">
      <ion-item
        routerLink="{{item.path}}"
        (click)="item.action ? item.action() : null"
      >
        <ion-icon color="primary" name="{{item.icon}}"></ion-icon>
        <ion-label>{{item.name}}</ion-label>
        <ion-icon name="arrow-forward-outline"></ion-icon>
      </ion-item>
    </ion-list>
  </ion-content>
</ion-menu>

<div class="ion-page" id="main-content">
  <ion-header>
    <ion-toolbar>
      <ion-buttons slot="start">
        <ion-menu-button color="primary"></ion-menu-button>
      </ion-buttons>
      <ion-icon
        slot="end"
        name="search"
        color="primary"
        (click)="openModal()"
      ></ion-icon>
    </ion-toolbar>
  </ion-header>

  <ion-content class="ion-padding">
    <h2>Últimos productos</h2>

    <app-product-card
      *ngFor="let product of listOfProducts"
      [product]="product"
    ></app-product-card>

    <ion-infinite-scroll threshold="100px" (ionInfinite)="loadMore($event)">
      <ion-infinite-scroll-content
        loadingSpinner="bubbles"
        loadingText="Cargando más..."
      ></ion-infinite-scroll-content>
    </ion-infinite-scroll>
  </ion-content>
</div>

<ion-modal
  trigger="open-modal"
  (willDismiss)="onCloseModal($event)"
  [isOpen]="showSearchModal"
>
  <ng-template>
    <ion-header>
      <ion-toolbar>
        <ion-buttons slot="start">
          <ion-button color="primary" (click)="cancel()">Cancelar</ion-button>
        </ion-buttons>
        <h5>Busqueda por producto</h5>
        <ion-buttons slot="end">
          <ion-button color="primary" (click)="confirm()" [strong]="true">
            Confirmar
          </ion-button>
        </ion-buttons>
      </ion-toolbar>
    </ion-header>
    <ion-content class="ion-padding">
      <div class="modal-container">
        <div class="search-input">
          <h4>Busque un producto:</h4>
          <form [formGroup]="productName">
            <ion-input
              mode="md"
              label="Producto"
              label-placement="floating"
              fill="outline"
              placeholder="Producto"
              class="custom-outline-input"
              formControlName="name"
            ></ion-input>
          </form>
        </div>

        <h4>Seleccione que alergenos desea eliminar</h4>
        <app-list-allergens-icons
          (changeAllergens)="setNewAllergens($event)"
          [editMode]="true"
        ></app-list-allergens-icons>
      </div>
    </ion-content>
  </ng-template>
</ion-modal>
